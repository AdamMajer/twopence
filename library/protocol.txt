Custom protocol
===============

The virtio and serial plugins use a custom protocol to communicate with
the system under tests.


Packet structure:

  0:	byte	Packet type
  1:	byte	Reserved
  2:	word	overall packet length
  4:	word	client ID
  6:	word	transaction ID
  8:		data

All header words are in network byte order (aka big-endian)


Packet types:

        local => system under tests
  'c'           run command
  'i'           insert file
  'e'           extract file
  'q'           quit
  '0'           stdin
  'E'           end of file on stdin, or during file injection
  'I'           interrupt command

        system under tests => local
  'M'           major error code
  'm'           minor error code
  '1'           stdout
  '2'           stderr
  'T'           command timeout
  'E'           end of file during extract transaction

            both directions
  'h'		hello packet (used to establish the client ID for all subsequent packets)
  'd'           file data
  'K'		keepalive packet

The length includes the 4 bytes of the header.


Parameters are separated with spaces:

  run command   username timeout command
  insert file   username filemode filename
  extract file  username filename

